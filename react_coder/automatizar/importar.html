<!DOCTYPE html>
<html>
<head>
  <title>Importar JSON a Firestore</title>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
</head>
<body>
  <h2>Importar JSON a Firestore</h2>
  <input type="file" id="jsonFile" accept=".json">
  <button onclick="importar()">Importar</button>
  <pre id="log"></pre>

  <script>
    // Configuración de Firebase
    var firebaseConfig = {
      apiKey: "AIzaSyDGKM493BtYyIHZyeFkXNETJ-5APDI8Lnk",
      authDomain: "react-coder-88065.firebaseapp.com",
      projectId: "react-coder-88065",
      storageBucket: "react-coder-88065.firebasestorage.app",
      messagingSenderId: "680484880299",
      appId: "1:680484880299:web:f7cf7b8cb3a1aa453b9cee"
    };
    firebase.initializeApp(firebaseConfig);
    // Fin configuración de Firebase
    var db = firebase.firestore();

    async function importar() {
      var fileInput = document.getElementById('jsonFile');
      var log = document.getElementById('log');
      if (!fileInput.files.length) {
        log.textContent = "Selecciona un archivo JSON primero.";
        return;
      }
      var reader = new FileReader();
      reader.onload = async function(e) {
        try {
          var data = JSON.parse(e.target.result);
          var count = 0;
          for (var i = 0; i < data.length; i++) {
            var item = data[i];
            if (!item.id) continue;
            await db.collection('products').doc(String(item.id)).set(item);
            count++;
          }
          log.textContent = `Importados ${count} documentos correctamente.`;
        } catch (err) {
          log.textContent = "Error: " + err.message;
        }
      };
      reader.readAsText(fileInput.files[0]);
    }
  </script>
</body>
</html>